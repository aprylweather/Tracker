code courtesy of DawnEggleton @ github
